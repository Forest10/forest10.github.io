---
title: 开发基本规范
date: 2018-01-28 14:24:35
tags: [develop]
---
## Basic quality:
* 字段注释需要完备
* [格式化挺重要的](https://www.v2ex.com/t/489742?p=2).是基本素质.
* controller里写大量逻辑在哪里也说不通.
## 最佳实践:

* 自动拆箱NPE问题.
* 使用占位符打印log能减少字符串连接.
* [不相信任何第三方接口](https://mp.weixin.qq.com/s/TNxkYeLyjlfZMBwn3kcRbA),注意降级及监控.
* 尽量failFast,不要一大团逻辑包在一个if里.
* 集合返回值返回对应的Collections.emptyXXX而不是null
* 使用@ControllerAdvice注解代替大批量无意义try catch
* 尽量不要使用BeanUtils.copyProperties这种形式进行对象间拷贝,如果嫌手工转化麻烦可使用generateo2o
    * 两个拷贝对象参数类型名称必须全都一致才符合预期效果.两者有其一发生改变,IDE都不会前置帮你规避这些错误!
    * 对象属性拷贝都是浅拷贝，意味着source内部的引用类型的属性值的变更会引起target对象值的变更)
* 嵌套属性连续取值容易造成NPE.但也不应该用[层级null判断](http://www.importnew.com/22060.html)然后取值.
* StringUtils.isNotBlank增加了对空白符的检查;使用StringUtils.EMPTY代替""会更优雅.
* 监控时间使用timer(String timerName, long milliseconds)而不是Timer.Context.因为如果把timer.stop()放在方法执行完之后执行的话本身方法有可能异常造成timer.stop()执行不到(不知道是否有内存泄漏问题),但是放在finally又会出现无论异常与否都会上报"默认成功"数据(相当于污染了成功指标)
## DB层:

* 使用对象而不是大量参数进行参数接收
* mapper里面创建和更新时间都不该人为干预,数据库进行管理.
* 关注下查询参数.数据库已经默认not null了.在真正执行查询之前应该直接逻辑判空然后返回,而不是依赖数据库做无意义判断.
* 关注下返回值.数据库无唯一性索引.直接返回单体entity应该是有问题的.不要妄想依赖逻辑来保证.墨菲定律在数据库这儿很适用.
